# Optimized Execution Prompt

**Quality Score:** [0-100]
**Recommended Model:** [Haiku/Sonnet/Opus]
**Estimated Cost:** [$X.XX]
**Generated:** [timestamp]

---

## Problem Statement

### What We're Building
[Clear, concrete description of what needs to be done]

### Why We're Building It
[Business value or user outcome]

### Root Problem Addressed
[Root cause discovered through problem discovery phase]

### Success Criteria
- [ ] [Measurable success criterion 1]
- [ ] [Measurable success criterion 2]
- [ ] [Measurable success criterion 3]

---

## Context & Constraints

### Tech Stack
- **Language:** [e.g., TypeScript]
- **Framework:** [e.g., React 18]
- **Database:** [e.g., PostgreSQL]
- **Infrastructure:** [e.g., AWS Lambda]

### Existing Patterns to Follow
✓ [Pattern 1 with reference: /src/auth/example.ts]
✓ [Pattern 2 with reference: /src/utils/example.ts]
✓ [Pattern 3 with reference]

### Constraints & Requirements
- [Constraint 1 with impact]
- [Constraint 2 with impact]
- [Constraint 3 with impact]

### Performance Targets
- [Target 1: e.g., "Load time < 100ms"]
- [Target 2: e.g., "Handle 1000 concurrent users"]

### Security Requirements
- [Security requirement 1]
- [Security requirement 2]

---

## Files to Create/Modify

### Primary Files
- [ ] `/path/to/file1.ts` - [Purpose]
  - Key responsibility: [What does this do]
  - Integration points: [What else does it talk to]

- [ ] `/path/to/file2.ts` - [Purpose]
  - Key responsibility: [What does this do]
  - Integration points: [What else does it talk to]

### Test Files
- [ ] `/path/to/file1.test.ts` - [Coverage scope]
- [ ] `/path/to/file2.test.ts` - [Coverage scope]

### Configuration (if needed)
- [ ] Update: [config file] - [What changes]

---

## Implementation Scope

### What to Include
✓ [Feature 1]
✓ [Feature 2]
✓ [Feature 3]

### What to Exclude (and why)
✗ [Feature not in scope] - (would expand timeline)
✗ [Feature not in scope] - (out of band)

### Acceptance Checklist
- [ ] All success criteria met
- [ ] Unit tests pass (>80% coverage)
- [ ] E2E tests pass
- [ ] Code follows project patterns
- [ ] Documentation updated
- [ ] No TypeScript errors
- [ ] Existing tests still pass

---

## Related Code References

### Similar Implementations
- [/src/path/example.ts] - [What to learn from this]
- [/src/path/example.ts] - [What to learn from this]

### Related Issues & PRs
- [PR #123] - [What it did]
- [Issue #456] - [What it was about]

### Architecture Documentation
- [Link to doc] - [What it covers]

---

## Estimated Effort & Complexity

**Complexity Level:** [Simple / Moderate / Complex]

**Estimated Size:**
- New code: ~[X] lines
- Tests: ~[X] lines
- Total files affected: [N]

**Key Challenges (if any):**
1. [Challenge 1 and approach]
2. [Challenge 2 and approach]

---

## Model-Specific Notes

### For Haiku Execution
[If recommending Haiku: Any special guidance]

### For Sonnet Execution
[If recommending Sonnet: Any special guidance]

### For Opus Execution
[If recommending Opus: Any special guidance]

---

## Quality Metrics from Refinement

| Category | Score | Status |
|----------|-------|--------|
| Specificity | [0-25] | ✓/⚠️ |
| Clarity | [0-25] | ✓/⚠️ |
| Context | [0-25] | ✓/⚠️ |
| Actionability | [0-25] | ✓/⚠️ |
| **Total** | **[0-100]** | ✓ Ready |

---

## Cost Estimation

**Execution Cost Estimates:**
- Haiku: $X.XX (if applicable)
- Sonnet: $X.XX (if applicable)
- Opus: $X.XX (if applicable)

**Total Workflow Cost** (discovery + refinement + execution):
- Haiku: ~$0.05 (discovery)
- Haiku: ~$0.03 (refinement)
- Sonnet: ~$0.18 (execution)
- **Total: ~$0.26**

vs. Direct Opus approach: ~$0.70 (50%+ savings)

---

## Pre-Execution Checklist

- [ ] Problem statement is clear
- [ ] Success criteria are measurable
- [ ] Tech stack is specified
- [ ] Existing patterns identified
- [ ] Constraints documented
- [ ] Related files referenced
- [ ] Scope is bounded
- [ ] Quality score ≥ 85/100

**Ready to execute:** [Yes / Need clarification]

---

## How to Use This Prompt

1. **Review** the problem statement and success criteria
2. **Check** the context and constraints
3. **Scan** the files to modify and related code
4. **Begin** implementation with the patterns specified

This prompt has been refined through multiple iterations to eliminate ambiguity and provide maximum clarity.
